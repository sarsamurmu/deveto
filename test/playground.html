<!DOCTYPE html>
<html lang="en" dir="ltr">

  <head>
    <meta charset="utf-8">
    <title>Devoid</title>
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link href="./resources/style.css" rel="stylesheet">
    <script src="./../dist/devoid.js"></script>
  </head>

  <body>
    <div renderBox></div>

    <label class="zust-checkbox themeToggle">
      <input type="checkbox" name="themeSwitch" id="themeSwitch" />
      <span></span>
      <span class="zust-unselectable">Dark Theme</span>
    </label>

    <script src="base.js"></script>
    <script type="text/javascript">
      window.addEventListener('DOMContentLoaded', () => {
        const {
          render,
          elements,
          Component,
          Fragment,
          createEl
        } = Devoid;

        const {
          div,
          p,
          button,
          a,
          br,
          textarea
        } = elements;

        const {
          AsyncBuilder,
          ValueNotifier,
          ListenerBuilder
        } = Devoid;

        class FragTest extends Component {
          build() {
            return new Fragment([
              new p({
                style: {
                  color: 'aqua'
                },
                children: 'First paragraph'
              }),
              new a({
                children: 'Link'
              })
            ]);
          }
        }

        const eventTest = new div({
          children: new (class extends Component {
            didMount() {
              console.log(`Mounted Level 1`);
            }

            build() {
              return new (class extends Component {
                didMount() {
                  console.log(`Mounted Level 2`)
                }

                build() {
                  return new (class extends Component {
                    didMount() {
                      console.log(`Mounted Level 3`)
                    }

                    build() {
                      return new (class extends Component {
                        didMount() {
                          console.log(`Mounted Level 4`)
                        }

                        build() {
                          return new p({
                            children: 'Link works'
                          })
                        }
                      })
                    }
                  })
                }
              })
            }
          }),
        })
        
        render(new (class extends Component {
          constructor() {
            super();
            this.state = { name: 'Flex' };
          }

          didUpdate() {
            console.log(`Updated`);
          }

          pClick = () => {
            this.rebuild()
          }

          buttonClick = () => {
            this.state.name = 'Drex';
            this.rebuild();
          }

          build() {
            return new p({
              on: {
                click: this.pClick,
              },
              children: [
                'My name is ',
                this.state.name,
                new br(),
                new button({
                  on: {
                    click: this.buttonClick,
                  },
                  children: 'Change name'
                })
              ]
            })
          }
        }), document.querySelector('[renderBox]'));
      });
    </script>
  </body>

</html>
